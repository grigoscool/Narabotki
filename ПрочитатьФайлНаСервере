&НаКлиенте
Процедура ПослеВыбораФайла(ВыбранныеФайлы,ДополнительныеПараметры) Экспорт
  Если ВыбранныеФайлы = Неопределено Тогда
  		Возврат;
  	Иначе 
  		ПутьКФайлу = ВыбранныеФайлы[0];
  	КонецЕсли;
  	ДанныеФайла = Новый ДвоичныеДанные(ПутьКФайлу);
  	АдресДанных = ПоместитьВоВременноеХранилище(ДанныеФайла);
  ДанныеФайла = ПолучитьИзВременногоХранилища(АдресДанных);
  	ПутьКФайлуНаСервере = ПолучитьИмяВременногоФайла("xls");
  	Если Объект.ПринадлежностьПеревозки <> ПредопределенноеЗначение("Перечисление.уатПринадлежностьТС.Привлеченное") Тогда
  		Сообщение = Новый СообщениеПользователю;
  		Сообщение.Текст = "Выбрано не привлеченное транспортное средство";
  		Сообщение.Сообщить();
  		Возврат;
  	КонецЕсли;
  	ДанныеФайла.Записать(ПутьКФайлуНаСервере);
  	Попытка
  		ТабДок.Прочитать(ПутьКФайлуНаСервере, СпособЧтенияЗначенийТабличногоДокумента.Значение);		
  	Исключение
  		Сообщение = Новый СообщениеПользователю;
  		Сообщение.Текст = "Не удалось прочитать указанный файл по причине " + ОписаниеОшибки();
  		Сообщение.Сообщить();
  		Возврат;
  	КонецПопытки;
