5. Оповещение пользователя 
5.1 Отправка письма на почту

ТипыКИ = Новый Массив;
ТипыКИ.Добавить(Перечисления.ТипыКонтактнойИнформации.АдресЭлектроннойПочты);

Объекты = Новый Массив();
ДиректорМТО = Константы.Расш1_ДиректорМТО.Получить();

Если Не ЗначениеЗаполнено(ДиректорМТО) Тогда
    
    Сообщить("Не удалось сформировать письмо об изменении статуса заказа клиента! Установите значение константы ""Директор МТО""!");
    Возврат;	

КонецЕсли;

Объекты.Добавить(Константы.Расш1_ДиректорМТО.Получить());
АдресаПолучателяМассив = УправлениеКонтактнойИнформацией.КонтактнаяИнформацияОбъектов(Объекты, ТипыКИ,,ТекущаяДатаСеанса());    

Если Не АдресаПолучателяМассив.Количество() Тогда

    Сообщить("Не удалось сформировать письмо об изменении статуса заказа клиента! Не удалось получить данные по почте Директора МТО!");
    Возврат;

КонецЕсли;

АдресаПолучателя = АдресаПолучателяМассив[0].Представление; 

ТекстПисьма = "Автоинформирование об изменении статуса заказа клиента. Необходимо выполнить дальнейшие действия по бизнес-процессу.";

ШаблонСтрокДанных = Символы.ПС + "Клиент: %1
|Контрагент: %2
|Заказ клиента: %3
|Сделка: %4
|Новый статус заказа: %5
|Приоритет: %6";

СтрокиДанных = СтрШаблон(ШаблонСтрокДанных, Партнер,Контрагент,Ссылка,Сделка,"К выполнению",Приоритет); 
ТекстПисьма = ТекстПисьма + СтрокиДанных; 


ПараметрыСообщения = Новый Структура;
ПараметрыСообщения.Вставить("Кому",     АдресаПолучателя);
ПараметрыСообщения.Вставить("Тема",     "Изменении статуса заказа клиента");
ПараметрыСообщения.Вставить("Тело",     ТекстПисьма);
ПараметрыСообщения.Вставить("Вложения", Новый Массив); 

СистемнаяУчётнаяЗапись = Справочники.УчетныеЗаписиЭлектроннойПочты.СистемнаяУчетнаяЗаписьЭлектроннойПочты;

Попытка
    
    НовоеПисьмо = РаботаСПочтовымиСообщениями.ПодготовитьПисьмо(СистемнаяУчётнаяЗапись,ПараметрыСообщения);
    РаботаСПочтовымиСообщениями.ОтправитьПисьмо(СистемнаяУчётнаяЗапись, НовоеПисьмо);
    Сообщить("Было сформировано письмо об изменении статуса заказа клиента.");
    
Исключение
     Сообщить("Не удалось сформировать письмо об изменении статуса заказа клиента!"); 
КонецПопытки;
////////////////////////////////////////////////////////////////////////////////
ПараметрыПисьма = Новый Структура;
ПараметрыПисьма.Вставить("Кому", АдресаКоторымОтправляемПисьма);
ПараметрыПисьма.Вставить("УчетнаяЗапись", ПочтаОтправителя);                                                               
ПараметрыПисьма.Вставить("АдресОтвета", АдресаКоторымОтправляемПисьма);
ПараметрыПисьма.Вставить("Тема", ТемаПисьма);	
ПараметрыПисьма.Вставить("Тело", ТекстПисьма);
ПараметрыПисьма.Вставить("ТипТекста", "ПростойТекст");
РаботаСПочтовымиСообщениями.ОтправитьПочтовоеСообщение(ПочтаОтправителя, ПараметрыПисьма);

5.2 В центр оповещений
ПоказатьОповещениеПользователя("Данные заполнены", ПолучитьНавигационнуюСсылку(ПоследняяДобавленнаяСсылка), 
	"Открыть последний добавленный товар", БиблиотекаКартинок.Справочник , СтатусОповещенияПользователя.Важное);
