
&НаКлиенте
Процедура Команда1(Команда)

	СтурктураДанныхОбработки = СтурктураДанныхОбработки();
    ВыполняемаяКоманда = Новый Структура(
        "Ссылка, Представление,
        |Идентификатор, ВариантЗапуска, ПоказыватьОповещение, 
        |Модификатор, ОбъектыНазначения, ЭтоОтчет, Вид");
        
    ЗаполнитьЗначенияСвойств(ВыполняемаяКоманда, СтурктураДанныхОбработки);
        
    ВыполняемаяКоманда.Идентификатор = Новый УникальныйИдентификатор;
    ВыполняемаяКоманда.ЭтоОтчет = Ложь;
    ДополнительныеОтчетыИОбработкиКлиент.ВыполнитьОткрытиеФормыОбработки(ВыполняемаяКоманда, Неопределено, Неопределено);
	
КонецПроцедуры

&НаСервере
Функция СтурктураДанныхОбработки()
	
    Обработка = Справочники.ДополнительныеОтчетыИОбработки.НайтиПоНаименованию("Формирование акта выполненных работ по маршрутным листам (ИТПл)");
    СтурктураДанныхОбработки = Новый Структура;
    СтурктураДанныхОбработки.Вставить("Ссылка", Обработка.Ссылка);
    СтурктураДанныхОбработки.Вставить("Вид", Обработка.Вид);
    Возврат СтурктураДанныхОбработки;

КонецФункции

// получение табДок из ВПФ
&НаСервере
Функция ПолучитьТабДокИзВПФ(МассивОбъектовНазначения, ИдентификаторКомандыПечати, ИмяВПФ)
	
	ССылкаВПФ = Справочники.ДополнительныеОтчетыИОбработки.НайтиПоНаименованию(ИмяВПФ);
	Если ССылкаВПФ.Пустая() Тогда
		Сообщить("Не найдена печ.форма реестра:\"+ИмяВПФ+"\ Обратитесь к знающим людям!");
		Возврат Неопределено;
	КонецЕсли;
	
	ПараметрыВывода = УправлениеПечатью.ПодготовитьСтруктуруПараметровВывода(); //}всякая шляпа, не имеющая отношения к формированию табдока
	
	ОбъектыПечати = Новый СписокЗначений; //заглушка
	
	КоллекцияФорм = УправлениеПечатью.ПодготовитьКоллекциюПечатныхФорм(ИдентификаторКомандыПечати); //}Функция БСП. Подготовка ТЗ, без заполненного ТабДока
	
	стПараметрыИсточника = Новый Структура;
	стПараметрыИсточника.Вставить("ИдентификаторКоманды",ИдентификаторКомандыПечати); 
	стПараметрыИсточника.Вставить("ОбъектыНазначения",МассивОбъектовНазначения); 
	
	УправлениеПечатью.ПечатьПоВнешнемуИсточнику(ССылкаВПФ,стПараметрыИсточника,КоллекцияФорм,ОбъектыПечати,ПараметрыВывода); //}Процедура БСП, заполняем табдок в ТЗ КоллФорм
	
	Рез = Неопределено;
	Если КоллекцияФорм.Количество() И ТипЗнч(КоллекцияФорм[0].ТабличныйДокумент) = Тип("ТабличныйДокумент") Тогда
		Рез = КоллекцияФорм[0].ТабличныйДокумент; //}получаем ТабДок, если он заполнен в ТЗ
	КонецЕсли;
	
	Возврат Рез;
	
КонецФункции
