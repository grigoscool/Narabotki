ВМЕСТО

//&НаКлиенте
//Процедура ПутьКФайлуНачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)
//	
//	Проводник = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);
//	Проводник.Заголовок = "Выберите файл для загрузки.";
//	Проводник.Фильтр = "Файл Excel (*.xls, *.xlsx)|*.xls;*.xlsx";
//	
//	Оповещение = Новый ОписаниеОповещения("ПослеВыбораФайла", ЭтотОбъект);
//	Проводник.Показать(Оповещение);
//	
//КонецПроцедуры

&НаКлиенте
Процедура ПослеВыбораФайла(ВыбранныеФайлы, ДополнительныеПараметры) Экспорт
	
	ОчиститьСообщения();
	
	Если ВыбранныеФайлы = Неопределено Тогда
		Возврат;
	ИначеЕсли ВыбранныеФайлы.Количество() > 1 Тогда
		Сообщение = Новый СообщениеПользователю;
		Сообщение.Текст = "Выберите только один файл.";
		Сообщение.Сообщить(); 
		Возврат;
	КонецЕсли;
	
	Файл = ВыбранныеФайлы[0];
	
	ПутьКФайлу = Файл;
		
КонецПроцедуры // ()

ПИШЕМ

&НаКлиенте
Асинх Процедура ПутьКФайлуНачалоВыбора(Элемент, ДанныеВыбора, СтандартнаяОбработка)
	
	Проводник = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);
	Проводник.Заголовок = "Выберите файл для загрузки.";
	Проводник.Фильтр = "Файл Excel (*.xls, *.xlsx)|*.xls;*.xlsx";
	
	ВыбранныеФайлы = Ждать Проводник.ВыбратьАсинх();
	
	ОчиститьСообщения();
	
	Если ВыбранныеФайлы = Неопределено Тогда
		Возврат;
	ИначеЕсли ВыбранныеФайлы.Количество() > 1 Тогда
		Сообщение = Новый СообщениеПользователю;
		Сообщение.Текст = "Выберите только один файл.";
		Сообщение.Сообщить(); 
		Возврат;
	КонецЕсли;
	
	Файл = ВыбранныеФайлы[0];
	
	ПутьКФайлу = Файл;
	
КонецПроцедуры
